<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶™‡ßç‡¶∞‡ßã‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶™‡ßÅ‡¶®‡¶∞‡ßç‡¶ú‡¶®‡ßç‡¶Æ</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        .theme-light-1 { --bg: #f0f9ff; --card: #ffffff; --text: #1e293b; --accent: #0ea5e9; --shadow: rgba(14,165,233,0.1); }
        .theme-light-2 { --bg: #fdf2f8; --card: #ffffff; --text: #831843; --accent: #db2777; --shadow: rgba(219,39,119,0.1); }
        .theme-light-3 { --bg: #f0fdf4; --card: #ffffff; --text: #14532d; --accent: #16a34a; --shadow: rgba(22,163,74,0.1); }
        .theme-light-4 { --bg: #fff7ed; --card: #ffffff; --text: #7c2d12; --accent: #ea580c; --shadow: rgba(234,88,12,0.1); }
        .theme-light-5 { --bg: #fafafa; --card: #ffffff; --text: #171717; --accent: #404040; --shadow: rgba(0,0,0,0.05); }
        .theme-dark-1 { --bg: #0f172a; --card: #1e293b; --text: #f1f5f9; --accent: #38bdf8; --shadow: rgba(0,0,0,0.3); }
        .theme-dark-2 { --bg: #1a1c2c; --card: #252945; --text: #e0e0e0; --accent: #ff79c6; --shadow: rgba(0,0,0,0.4); }
        .theme-dark-3 { --bg: #052e16; --card: #064e3b; --text: #ecfdf5; --accent: #34d399; --shadow: rgba(0,0,0,0.5); }
        .theme-dark-4 { --bg: #2d1b69; --card: #4c1d95; --text: #f5f3ff; --accent: #a78bfa; --shadow: rgba(0,0,0,0.3); }
        .theme-dark-5 { --bg: #171717; --card: #262626; --text: #ffffff; --accent: #facc15; --shadow: rgba(0,0,0,0.6); }

        body { background-color: var(--bg); color: var(--text); font-family: 'Hind Siliguri', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; transition: 0.5s; overflow: hidden; }
        .container { background: var(--card); padding: 40px 25px; border-radius: 40px; box-shadow: 0 25px 50px var(--shadow); width: 90%; max-width: 400px; text-align: center; position: relative; z-index: 10; }
        .top-btns { position: absolute; top: 20px; right: 20px; display: flex; gap: 8px; }
        .icon-btn { background: var(--card); border: 1.2px solid var(--accent); cursor: pointer; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 13px; transition: 0.3s; padding: 0; color: var(--text); }
        .icon-btn:hover { transform: scale(1.1); background: var(--bg); }
        h1 { font-size: 2.2rem; color: var(--accent); margin-bottom: 5px; font-weight: 700; letter-spacing: 0.5px; }
        .subtitle { opacity: 0.85; font-size: 1.1rem; margin-top: 0px; margin-bottom: 15px; font-weight: 500; }
        #days-val { font-size: 6.5rem; font-weight: 700; display: block; line-height: 1; margin: 10px 0; font-family: 'Arial', sans-serif; }
        .label { font-size: 1.1rem; opacity: 0.8; font-weight: 600; text-transform: uppercase; }
        .medal-container { display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; margin-top: 20px; }
        .medal { font-size: 1.5rem; filter: grayscale(1); transition: 0.5s; opacity: 0.2; cursor: help; }
        .medal.active { filter: grayscale(0); opacity: 1; transform: scale(1.1); }
        .btn { background: var(--accent); color: white; border: none; padding: 14px; border-radius: 50px; font-weight: 600; font-family: inherit; cursor: pointer; margin-top: 20px; width: 100%; font-size: 1rem; transition: 0.3s; }
        .emergency-text { font-size: 1.1rem; font-weight: 600; color: #ef4444; line-height: 1.5; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        #details-box { display: none; margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.05); border-radius: 20px; font-size: 0.9rem; }
        .pass-wrapper { position: relative; width: 100%; }
        .eye-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; opacity: 0.6; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 12px; border: 1px solid var(--accent); background: var(--bg); color: var(--text); font-family: inherit; box-sizing: border-box; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(8px); z-index: 100; }
        .modal-content { background: var(--card); color: var(--text); width: 85%; max-width: 350px; padding: 30px; border-radius: 30px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .hidden { display: none !important; }
    </style>
</head>
<body id="body-tag">

    <div id="auth-screen" class="container">
        <h1> ‡¶™‡ßç‡¶∞‡ßã‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶™‡ßÅ‡¶®‡¶∞‡ßç‡¶ú‡¶®‡ßç‡¶Æ</h1>
        <p class="subtitle">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        <input type="email" id="login-email" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤">
        <div class="pass-wrapper">
            <input type="password" id="login-pass" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
            <span class="eye-icon" onclick="togglePassView()">üëÅÔ∏è</span>
        </div>
        <button class="btn" id="login-btn">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div id="main-app" class="container hidden">
        <div class="top-btns">
            <button class="icon-btn" onclick="openModal()" title="‡¶∏‡¶Æ‡ßü ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®">üïí</button>
            <button class="icon-btn" onclick="manualThemeChange()" title="‡¶•‡¶ø‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®">üé®</button>
            <button class="icon-btn" onclick="showEmergency()" style="color:#ef4444; border-color:#ef4444;" title="SOS">‚ö†Ô∏è</button>
            <button class="icon-btn" onclick="logoutUser()" style="color:#ef4444; border-color:#ef4444;" title="‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü">üö™</button>
        </div>
        <h1 style="margin-bottom: 0px">‡¶™‡ßç‡¶∞‡ßã‡¶ú‡ßá‡¶ï‡ßç‡¶ü ‡¶™‡ßÅ‡¶®‡¶∞‡ßç‡¶ú‡¶®‡ßç‡¶Æ</h1>
        <p class="subtitle">‡¶®‡¶ø‡¶ú‡ßá‡¶ï‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶∞‡ßá ‡¶ó‡¶°‡¶º‡¶æ‡¶∞ ‡¶∂‡¶™‡¶•</p>
        <span id="days-val">0</span>
        <span class="label">‡¶¶‡¶ø‡¶® ‡¶∏‡¶´‡¶≤</span>

        <div class="medal-container">
            <span id="medal-1" class="medal" title="‡ßß ‡¶¶‡¶ø‡¶® ‡¶∏‡¶´‡¶≤">üõ°Ô∏è</span>
            <span id="medal-7" class="medal" title="‡ßß ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π ‡¶∏‡¶´‡¶≤">üèÖ</span>
            <span id="medal-30" class="medal" title="‡ßß ‡¶Æ‡¶æ‡¶∏ ‡¶∏‡¶´‡¶≤">üíé</span>
            <span id="medal-90" class="medal" title="‡ß© ‡¶Æ‡¶æ‡¶∏ ‡¶∏‡¶´‡¶≤">üî•</span>
            <span id="medal-180" class="medal" title="‡ß¨ ‡¶Æ‡¶æ‡¶∏ ‡¶∏‡¶´‡¶≤">üëë</span>
            <span id="medal-270" class="medal" title="‡ßØ ‡¶Æ‡¶æ‡¶∏ ‡¶∏‡¶´‡¶≤">üåå</span>
            <span id="medal-365" class="medal" title="‡ßß ‡¶¨‡¶õ‡¶∞ ‡¶∏‡¶´‡¶≤">üöÄ</span>
        </div>
        
        <button class="btn" onclick="toggleDetails()" id="btn-text">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
        <div id="details-box"></div>
    </div>

    <div class="modal" id="time-modal">
        <div class="modal-content">
            <h3 style="margin-top:0;">‡¶∏‡¶Æ‡ßü ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£</h3>
            <p style="font-size: 0.8rem; opacity: 0.7;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶∏‡¶Æ‡ßü‡¶ü‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            <input type="datetime-local" id="manual-date">
            <button class="btn" id="save-cloud-btn">‡¶∏‡¶Æ‡ßü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <p onclick="closeModal()" style="cursor:pointer; margin-top:15px; opacity:0.6; font-size:0.9rem;">‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAO7cN-tZXl06VetScOfNnt1PAa5X5VYE4",
            authDomain: "punorjonmo-bdc5d.firebaseapp.com",
            projectId: "punorjonmo-bdc5d",
            storageBucket: "punorjonmo-bdc5d.firebasestorage.app",
            messagingSenderId: "456028735818",
            appId: "1:456028735818:web:5aec4faa76a1b197ac59b3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                loadFromCloud(user.uid);
            } else {
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('main-app').classList.add('hidden');
            }
        });

        async function saveToCloud(ts) {
            if(!auth.currentUser) return;
            const uid = auth.currentUser.uid;
            const dataToSave = { startDate: ts };
            await setDoc(doc(db, "users", uid), dataToSave, { merge: true });
            localStorage.setItem('startDate', ts);
            updateCounter();
        }

        async function loadFromCloud(uid) {
            const snap = await getDoc(doc(db, "users", uid));
            if (snap.exists()) {
                const data = snap.data();
                localStorage.setItem('startDate', data.startDate);
                updateCounter();
            }
        }

        document.getElementById('save-cloud-btn').onclick = () => {
            const newVal = new Date(document.getElementById('manual-date').value).getTime();
            if(newVal > Date.now()) return alert("‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá ‡¶Ø‡¶æ‡¶ì‡ßü‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶®‡ßü!");
            saveToCloud(newVal);
            closeModal();
            alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶Æ‡ßü ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        };

        document.getElementById('login-btn').onclick = async () => {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;
            try { await signInWithEmailAndPassword(auth, email, pass); } catch (e) { alert("‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
        };
        window.logoutUser = () => signOut(auth);

        window.togglePassView = function() {
            const p = document.getElementById('login-pass');
            const icon = document.querySelector('.eye-icon');
            p.type = (p.type === "password") ? "text" : "password";
            icon.innerText = (p.type === "password") ? "üëÅÔ∏è" : "üîí";
        };

        window.updateCounter = function() {
            const start = localStorage.getItem('startDate') || Date.now();
            const diff = Date.now() - start;
            let d = Math.floor(diff / (1000 * 60 * 60 * 24));
            
            document.getElementById('days-val').innerText = d;

            const milestones = [1, 7, 30, 90, 180, 270, 365];
            milestones.forEach(m => {
                const el = document.getElementById(`medal-${m}`);
                if (el) {
                    if (d >= m) el.classList.add('active');
                    else el.classList.remove('active');
                }
            });

            let s = Math.floor(diff / 1000);
            let mi = Math.floor(s / 60);
            let h = Math.floor(mi / 60);
            let w = Math.floor(d / 7);
            let mo = Math.floor(d / 30);

            let parts = [];
            if (mo > 0) parts.push(`<b>${mo}</b> ‡¶Æ‡¶æ‡¶∏`);
            if (w % 4 > 0) parts.push(`<b>${w % 4}</b> ‡¶∏‡¶™‡ßç‡¶§‡¶æ‡¶π`);
            if (d % 7 > 0) parts.push(`<b>${d % 7}</b> ‡¶¶‡¶ø‡¶®`);
            if (h % 24 > 0) parts.push(`<b>${h % 24}</b> ‡¶ò‡¶£‡ßç‡¶ü‡¶æ`);
            if (mi % 60 > 0) parts.push(`<b>${mi % 60}</b> ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü`);
            parts.push(`<b>${s % 60}</b> ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`);

            const detailsBox = document.getElementById('details-box');
            if(detailsBox && detailsBox.style.display === "block" && !detailsBox.querySelector('.emergency-text')) {
                detailsBox.innerHTML = "‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ü‡¶∏‡¶ï‡ßç‡¶§‡¶ø ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§ ‡¶Ü‡¶õ‡ßá‡¶®:<br>" + parts.join(', ');
            }
        }
    </script>

    <script>
        function getCurrentThemeList() {
            return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 
                ['theme-dark-1', 'theme-dark-2', 'theme-dark-3', 'theme-dark-4', 'theme-dark-5'] : 
                ['theme-light-1', 'theme-light-2', 'theme-light-3', 'theme-light-4', 'theme-light-5'];
        }

        function applyRandomTheme() {
            const list = getCurrentThemeList();
            document.getElementById('body-tag').className = list[Math.floor(Math.random() * list.length)];
        }

        window.onload = () => {
            applyRandomTheme();
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('manual-date').value = now.toISOString().slice(0, 16);
            updateCounter();
        };

        function manualThemeChange() {
            const body = document.getElementById('body-tag');
            const list = getCurrentThemeList();
            let idx = (list.indexOf(body.className) + 1) % list.length;
            body.className = list[idx];
        }

        function openModal() { document.getElementById('time-modal').style.display = 'block'; }
        function closeModal() { document.getElementById('time-modal').style.display = 'none'; }

        function toggleDetails() {
            const box = document.getElementById('details-box');
            const isHidden = box.style.display === "none" || box.style.display === "";
            box.style.display = isHidden ? "block" : "none";
            document.getElementById('btn-text').innerText = isHidden ? "‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®" : "‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®";
            if(isHidden) updateCounter();
        }

        function showEmergency() {
            const box = document.getElementById('details-box');
            const emergencyQuotes = ["‡¶è‡¶á ‡¶ï‡ßü‡ßá‡¶ï ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶§‡ßÉ‡¶™‡ßç‡¶§‡¶ø ‡¶ï‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Ü‡¶§‡ßç‡¶Æ‡¶∏‡¶Æ‡ßç‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶ö‡ßá‡ßü‡ßá‡¶ì ‡¶¶‡¶æ‡¶Æ‡ßÄ?", "‡¶Ü‡¶ú ‡¶π‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶®‡¶≤‡ßá ‡¶ï‡¶æ‡¶≤ ‡¶∏‡¶ï‡¶æ‡¶≤‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶Ü‡ßü‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶Æ‡¶®‡ßá ‡¶¶‡¶æ‡¶Å‡ßú‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶® ‡¶§‡ßã?", "‡¶ï‡ßç‡¶∑‡¶£‡¶∏‡ßç‡¶•‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶Ü‡¶®‡¶®‡ßç‡¶¶ ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶∏‡ßç‡¶•‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶¨‡¶ø‡¶∑‡¶£‡ßç‡¶£‡¶§‡¶æ ‡¶â‡¶™‡¶π‡¶æ‡¶∞ ‡¶¶‡ßá‡¶¨‡ßá‡•§", "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡ßé ‡¶∏‡¶Ç‡¶∏‡ßç‡¶ï‡¶∞‡¶£ ‡¶Ü‡¶ú ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ö‡¶æ‡¶á‡¶õ‡ßá, ‡¶§‡¶æ‡¶ï‡ßá ‡¶π‡¶§‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§"];
            box.innerHTML = `<div class="emergency-text">‚ö†Ô∏è ${emergencyQuotes[Math.floor(Math.random() * emergencyQuotes.length)]}</div>`;
            box.style.display = "block";
            document.getElementById('btn-text').innerText = "‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®";
        }

        setInterval(() => { if(window.updateCounter) window.updateCounter(); }, 1000);
    </script>
</body>
</html>